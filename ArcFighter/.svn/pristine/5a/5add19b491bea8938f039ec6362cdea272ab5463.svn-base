program prog_knife_hit;

uses
	//wingraph,wincrt
	osxbgi;

type

	TCoord = record
		x,y : real;		
	end;

	TKnifeType = record
		Position: TCoord;
		Speed: TCoord;
	end;

var
	Knife: TKnifeType;

procedure StartGraphics();
var
	gm,gd: smallInt;
begin
	gd := Nopalette;	
	gm := m800x600;
	InitGraph(gd,gm, '');
end;

procedure DrawBackGround();
begin
	
	setfillstyle(SolidFill, MidnightBlue);
	bar(0, 0, 800, 100);

	setfillstyle(SolidFill, DarkSlateBlue);
	bar(0, 100, 800, 200);

	setfillstyle(SolidFill, SlateBlue);
	bar(0, 200, 800, 300);

	setfillstyle(SolidFill, MediumSlateBlue);//CeruleanBlue
	bar(0, 300, 800, 400);
	
	setfillstyle(SolidFill, Lilac);//Cerulean
	bar(0, 400, 800, 500);

	setfillstyle(SolidFill, Thistle);//DodgerBlue
	bar(0, 500, 800, 600);
	
	//tfillstyle(SolidFill, lightgreen);
	//r(0,300, 800, 600);
end;

procedure DrawTree(x, y : Integer);
begin
	SetColor(Sepia);
	setfillstyle(SolidFill, Sepia);
	FillEllipse (x, y, 100,100);

	SetColor(Gold);
	setfillstyle(SolidFill, Gold);
	FillEllipse (x, y, 90,90);

	SetColor(SelectiveYellow);
	setfillstyle(SolidFill, SelectiveYellow);
	FillEllipse (x, y, 70,70);

	SetColor(Gold);
	setfillstyle(SolidFill, Gold);
	FillEllipse (x, y, 50,50);

	SetColor(SelectiveYellow);
	setfillstyle(SolidFill, SelectiveYellow);
	FillEllipse (x, y, 30,30);

	SetColor(Gold);
	setfillstyle(SolidFill, Gold);
	FillEllipse (x, y, 10,10);

end;
procedure DrawKnife(x,y : Integer);
var
	polygon: array [0..4] of PointType;
	polygon1: array [0..3] of PointType;
	polygon2: array [0..3] of PointType;

begin
	polygon[0].x := x;
	polygon[0].y := y;

	polygon[1].x := x + 10;
	polygon[1].y := y + 20;

	polygon[2].x := x + 10;
	polygon[2].y := y + 70;

	polygon[3].x := x - 10;
	polygon[3].y := y + 70;

	polygon[4].x := x - 10;
	polygon[4].y := y + 20;

	SetFillStyle(solidFill, LightSkyBlue);
	SetColor(white);
	FillPoly(5, polygon);

	polygon1[0].x := x + 15;
	polygon1[0].y := y + 70;

	polygon1[1].x := x + 15;
	polygon1[1].y := y + 80;

	polygon1[2].x := x - 15;
	polygon1[2].y := y + 80;

	polygon1[3].x := x - 15;
	polygon1[3].y := y + 70;

	SetFillStyle(solidFill, Burgundy);
	SetColor(Burgundy);
	FillPoly(4, polygon1);

	polygon2[0].x := x + 7;
	polygon2[0].y := y + 80;

	polygon2[1].x := x + 7;
	polygon2[1].y := y + 100;

	polygon2[2].x := x - 7;
	polygon2[2].y := y + 100;

	polygon2[3].x := x - 7;
	polygon2[3].y := y + 80;

	SetFillStyle(solidFill, Cinnamon);
	SetColor(Cinnamon);
	FillPoly(4, polygon2);

	SetFillStyle(solidFill, PaleTurquoise);
	SetColor(Cinnamon);

	//FillEllipse(400, 600, 8, 8);

end;

procedure DrawRotateKnife();
var
	polygon3: array [0..4] of PointType;
	polygon4: array [0..3] of PointType;
	polygon5: array [0..3] of PointType;
	fi: real;
	x0,y0,radius,i:Integer;
begin

	x0:=400;
	y0:=200;
	//radius:= 50;
	i:= 1;


	updateGraph(UpdateOff);

    while true do 
    begin
        ClearDevice();

        fi:= 0.05 * i;
        i:= i + 1;
        //readkey();

		polygon3[0].x := x0 + round (80*cos(fi + 3*pi/2));
		polygon3[0].y := y0 - round (80*sin(fi + 3*pi/2));

		polygon3[1].x := x0 + round (95*cos(fi + 275*pi/180));
		polygon3[1].y := y0 - round (95*sin(fi + 275*pi/180));

		polygon3[2].x := x0 + round (135*cos(fi + 273*pi/180));
		polygon3[2].y := y0 - round (135*sin(fi + 273*pi/180));

		polygon3[3].x := x0 + round (135*cos(fi + 265*pi/180));
		polygon3[3].y := y0 - round (135*sin(fi + 265*pi/180));

		polygon3[4].x := x0 + round (95*cos(fi + 265*pi/180));
		polygon3[4].y := y0 - round (95*sin(fi + 265*pi/180));

		SetFillStyle(solidFill, LightSkyBlue);
		SetColor(white);
		FillPoly(5, polygon3);


		polygon4[0].x := x0 + round (135*cos(fi + 275.5*pi/180));
		polygon4[0].y := y0 - round (135*sin(fi + 275.5*pi/180));

		polygon4[1].x := x0 + round (145*cos(fi + 275.5*pi/180));
		polygon4[1].y := y0 - round (145*sin(fi + 275.5*pi/180));

		polygon4[2].x := x0 + round (145*cos(fi + 263.5*pi/180));
		polygon4[2].y := y0 - round (145*sin(fi + 263.5*pi/180));

		polygon4[3].x := x0 + round (135*cos(fi + 263.5*pi/180));
		polygon4[3].y := y0 - round (135*sin(fi + 263.5*pi/180));

		SetFillStyle(solidFill, Burgundy);
		SetColor(Burgundy);
		FillPoly(4, polygon4);

		polygon5[0].x := x0 + round (145*cos(fi + 272*pi/180));
		polygon5[0].y := y0 - round (145*sin(fi + 272*pi/180));

		polygon5[1].x := x0 + round (165*cos(fi + 272*pi/180));
		polygon5[1].y := y0 - round (165*sin(fi + 272*pi/180));

		polygon5[2].x := x0 + round (165*cos(fi + 266.5*pi/180));
		polygon5[2].y := y0 - round (165*sin(fi + 266.5*pi/180));


		polygon5[3].x := x0 + round (145*cos(fi + 266.5*pi/180));
		polygon5[3].y := y0 - round (145*sin(fi + 266.5*pi/180));

		
		SetFillStyle(solidFill, Cinnamon);
		SetColor(Cinnamon);
		FillPoly(4, polygon5);

		{SetFillStyle(solidFill, PaleTurquoise);
		SetColor(Cinnamon);

		FillEllipse(400, 600, 8, 8);}


		updateGraph(UpdateNow);
        Delay(20);

	end;	

end;

var
	Isquit: boolean;

procedure Keyboard();
var
	button: char; 
	i: integer;
begin

	Isquit := false;

	if (keypressed()) then
	begin
		button := readkey();

		if (button = 'q') then
		begin
	
			Isquit := true;
			exit;
		end;

		if (button = 'w') then
		begin
			knife.Position.y := knife.Position.y + knife.Speed.y;
		end;

	end;	
end;

var
	i: Integer;

begin	
	
	StartGraphics();

	knife.Position.x := 400;
	knife.Position.y := 500;
	knife.Speed.x := 0;
	knife.Speed.y :=  - 2;


	UpdateGraph(UpdateOff);

	

	UpdateGraph(UpdateNow);

	while (true) do
	begin
			
		ClearDevice();

		DrawBackGround();

		DrawTree(400,200);

		DrawKnife(
			round(knife.Position.x),
			round(knife.Position.y)
			);

		//DrawRotateKnife();

		UpdateGraph(UpdateNow);

		//Delay(20); 


		Keyboard();
	
		if (Isquit) then
		begin
			break;			
		end;
	end;

	ClearDevice();
	SetColor(Red);
	circle(400,300, 100);
	UpdateGraph(UpdateNow);
	readkey();

	CloseGraph();
end.


