uses
	osxbgi, 
	sysutils;

const
	//в процессе работы программы их менять нельзя
	SpaceObjects = 2; 

type
	//перечесляемый тип (enumeration)
	TSpaceCodeType = (codeSpaseMan, codeUFO, codeMagicStar);

	TCoord = record
		x,y : real;	
	end;

	TSpace = record
		Position: TCoord;
		Speed: TCoord;
		code: TSpaceCodeType;
		symbol: char;	
	end;

	var
		Space: array[0..2] of TSpace;
		HIT: Integer;

procedure StartGraphics();
var
	gm,gd: smallInt;
begin
	//полноцветный режим (это параметр)
	gd := Nopalette; 
	//разрешение, размер окна (это параметр)	
	gm := m800x600;	
	//создать окно (это функция/процедура)
	InitGraph(gd,gm, ''); 
end;

//прописываем условия рисования каждого объекта
procedure DrawSpaceMan(x,y: Integer);
begin
	setfillstyle(SolidFill, orange);
	SetColor(orange);
	FillEllipse(x,y, 20,30);	
end;

procedure DrawUFO(x,y: Integer);
begin
	setfillstyle(SolidFill, green);
	SetColor(green);
	FillEllipse(x,y, 40,15);	
end;

procedure DrawMagicStar(x,y: Integer);
begin
	setfillstyle(SolidFill, yellow);
	SetColor(yellow);
	FillEllipse(x,y, 5,5);	
end;

//прописываем условия рисования объектов
procedure DrawSpaceObjects(var parametr1: TSpace);
var
	intx, inty, i: Integer;
begin

	for i := 0 to SpaceObjects do
	begin
		intx := round(parametr1.Position.x);
		inty := round(parametr1.Position.y);

	if (parametr1.code = codeSpaseMan) then
	begin
		DrawSpaceMan(intx, inty);
	end;

	if (parametr1.code = codeUFO) then
	begin
		DrawUFO(intx, inty);
	end;

	if (parametr1.code = codeMagicStar) then
	begin
		DrawMagicStar(intx, inty);
	end;
	SetColor(white);
	OutTextXY(intx + 20, inty + 30, parametr1.symbol);
	end;
end;

//условия рисования всех объектов
procedure DrawAllObjects(SpaceObjects: Integer);
var
	i: Integer;
begin
	for i := 0 to SpaceObjects do
	begin
		DrawSpaceObjects(Space[i]);
	end;

end;

//условия движения всех объектов
procedure DrawMotion(SpaceObjects: Integer);

begin
	//движение летающей тарелки
	Space[1].Position.x := Space[1].Position.x + Space[1].Speed.x;
	Space[1].Position.y := Space[1].Position.y + Space[1].Speed.y;
end;

var
	Isquit: Boolean;

procedure Keyboard();
var
	button: char;


//Значение по умолчанию - продолжать работать (не выходить)
//Keyboard := false;
begin
	Isquit := false;

	if (keypressed()) then
	begin
		button := readkey();
		//завершение программы
		if (button = 'q') then
		begin
			//Keyboard := true; // в этом случае - выходить
			Isquit := true;
			exit;
		end;

		if (button = 'r') then
			begin
				Space[0].Position.x := Space[0].Position.x + Space[0].Speed.x;
			end;

		if (button = 'l') then
			begin
				Space[0].Position.x := Space[0].Position.x - Space[0].Speed.x;
			end;

		if (button = 'c') then
		begin
			Space[2].Position.y := Space[2].Position.y - Space[2].Speed.y;
		end;

		if (upcase(button) = upcase(Space[1].symbol)) then
		begin
			Space[1].Position.x := Space[1].Position.x + random (700) + 20;
			Space[1].Position.y := 0;
		end;
	end;
end;

var
	Distance: Real;
	coordinateX: Integer;
begin
	HIT:= 0;
	StartGraphics();

	Space[0].Position.x := 400;
	Space[0].Position.y := 550;
	Space[0].Speed.x := 10;
	Space[0].code := codeSpaseMan;
	Space[0].symbol := 'r';
	
	Space[1].Position.x := 50;
	Space[1].Position.y := 100;
	Space[1].Speed.x := 5;
	Space[1].code := codeUFO;
	Space[1].symbol := 'u';

	Space[2].Position.x := 420;
	Space[2].Position.y := 500;
	Space[2].Speed.y := 10;
	Space[2].code := codeMagicStar;
	Space[2].symbol := 'c';

	UpdateGraph(UpdateOff);

	//ждёт нажатия любой клавиши и возвращает значение 
	readkey();

	UpdateGraph(UpdateNow);

	while (true) do
	begin
		
		ClearDevice();
		
		SetColor(white);
		OutTextXY(50,50, 'HIT  ' + inttostr(HIT));

		DrawAllObjects(SpaceObjects);
		DrawMotion(SpaceObjects);

	
		UpdateGraph(UpdateNow);

	Delay(20); 
		
	Keyboard();

	if (Space[1].Position.x > 760) then
	begin
		Space[1].Position.x := 10;
	end;

	if (Space[2].Position.y < 0) then
	begin
		Space[2].Position.y := 570;
		Space[2].Position.x := random (700) + 20;
	end;

		//здесь я хотела записать условие столкновения летающего объекта и звезды 
		Distance := sqrt(
		sqr (Space[1].Position.x - Space[2].Position.x) + 
		sqr (Space[1].Position.y - Space[2].Position.y)
		);
		IF Distance <= (10 + 10) then
		begin
			Space[1].Position.x := 900;
			Space[2].Position.x := 900;	
			HIT:= HIT + 1;
		end;

	if (Isquit) then
		begin
			break;
		end;
	end;

	ClearDevice();
	SetColor(orange);
	OutTextXY(330,300, 'Dont Panic Spaceman');
	UpdateGraph(UpdateNow);
	readkey();

	//закрывает окна
	CloseGraph();
end.



























